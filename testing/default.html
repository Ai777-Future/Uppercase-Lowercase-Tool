<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Text → Table → Excel (Faculty Cleaner)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--muted:#94a3b8;--accent:#06b6d4}
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;background:linear-gradient(180deg,#071029 0%,#061425 100%);color:#e6eef6;padding:28px}
    .container{max-width:1100px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px}
    h1{margin:0;font-size:20px}
    p.lead{margin:6px 0 18px;color:var(--muted);font-size:13px}

    .card{background:rgba(255,255,255,0.02);padding:18px;border-radius:12px;box-shadow:0 6px 20px rgba(2,6,23,0.6);margin-bottom:18px}
    textarea{width:100%;min-height:220px;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;resize:vertical}
    .row{display:flex;gap:12px;align-items:center}
    label{font-size:13px;color:var(--muted)}
    input[type=number], input[type=text], select{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    button{background:linear-gradient(90deg,var(--accent),#60a5fa);border:0;color:#021124;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

    .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
    .preview{overflow:auto;max-height:420px;margin-top:12px;border-radius:8px}
    table{border-collapse:collapse;width:100%}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left;font-size:13px}
    th{position:sticky;top:0;background:rgba(2,6,23,0.6);backdrop-filter:blur(6px)}

    footer{margin-top:14px;color:var(--muted);font-size:13px}

    .hint{font-size:12px;color:var(--muted);margin-top:6px}
    @media (max-width:720px){.row{flex-direction:column;align-items:stretch}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Faculty Cleaner → Arrange → Excel</h1>
        <p class="lead">Paste raw numbered list, remove numbering, choose how many names per row and download as Excel.</p>
      </div>
    </header>

    <div class="card">
      <label for="raw">1) Paste raw data here (the text you gave):</label>
      <textarea id="raw" placeholder="Paste your raw list (with (1), (2) numbering) here..."></textarea>

      <div class="controls">
        <div style="min-width:180px">
          <label>2) Delimiter for splitting initial items</label>
          <select id="delimiter">
            <option value=",">Comma (,)</option>
            <option value="newline">New line</option>
            <option value="both">Comma or New line</option>
            <option value="custom">Custom</option>
          </select>
          <input id="customDelim" type="text" placeholder="When custom chosen, type delimiter" style="margin-top:6px;display:none;width:100%">
        </div>

        <div style="min-width:140px">
          <label>3) Remove numbering like (123)</label>
          <div style="margin-top:6px"><input id="rmNum" type="checkbox" checked> Remove numbers</div>
        </div>

        <div style="min-width:140px">
          <label>4) Names per row (columns)</label>
          <input id="perRow" type="number" min="1" value="5">
        </div>

        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <button id="arrangeBtn">Arrange & Preview</button>
          <button id="downloadBtn" class="ghost">Download Excel</button>
        </div>
      </div>

      <div class="hint">Tip: For your faculty list, choose <strong>Comma</strong> or <strong>Both</strong> as delimiter. The tool will trim whitespace and drop empty entries.</div>
    </div>

    <div class="card">
      <h3 style="margin:0 0 8px 0">Preview (table)</h3>
      <div id="preview" class="preview">
        <table id="outTable"><thead></thead><tbody></tbody></table>
      </div>
    </div>

    <footer>
      Made for quick cleaning — paste, click <strong>Arrange & Preview</strong>, then <strong>Download Excel</strong>. Uses SheetJS to create .xlsx in-browser.
    </footer>
  </div>

  <!-- SheetJS CDN for client-side Excel export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    const rawEl = document.getElementById('raw');
    const delimiterEl = document.getElementById('delimiter');
    const customDelimEl = document.getElementById('customDelim');
    const rmNumEl = document.getElementById('rmNum');
    const perRowEl = document.getElementById('perRow');
    const arrangeBtn = document.getElementById('arrangeBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const outTable = document.getElementById('outTable');

    delimiterEl.addEventListener('change', ()=>{
      customDelimEl.style.display = delimiterEl.value === 'custom' ? 'block' : 'none';
    });

    function cleanItem(item, removeNumbers){
      let s = item.trim();
      if(removeNumbers){
        // Remove patterns like (123) or (DISA) preceding or inside
        s = s.replace(/\(\s*\d+\s*\)/g, '');
        // Remove standalone (DISA) or other all-caps tags
        s = s.replace(/\(\s*[A-Za-z\.\s-]{1,20}\s*\)/g, '');
      }
      // Also strip leading/trailing punctuation
      s = s.replace(/^[-\u2013\u2014\s\.:,]+|[-\u2013\u2014\s\.:,]+$/g, '');
      return s.trim();
    }

    function parseRaw(text){
      const delim = delimiterEl.value;
      let items = [];
      if(delim === ','){
        items = text.split(',');
      } else if(delim === 'newline'){
        items = text.split(/\r?\n/);
      } else if(delim === 'both'){
        items = text.split(/,|\r?\n/);
      } else {
        const d = customDelimEl.value || ',';
        items = text.split(d);
      }
      return items.map(it=>it.trim()).filter(Boolean);
    }

    function buildGrid(items, cols){
      const rows = [];
      for(let i=0;i<items.length;i+=cols){
        rows.push(items.slice(i,i+cols));
      }
      return rows;
    }

    function renderTable(grid){
      const thead = outTable.querySelector('thead');
      const tbody = outTable.querySelector('tbody');
      thead.innerHTML = '';
      tbody.innerHTML = '';
      if(grid.length === 0) return;
      const cols = Math.max(...grid.map(r=>r.length));
      // header
      const trh = document.createElement('tr');
      for(let c=0;c<cols;c++){
        const th = document.createElement('th');
        th.textContent = 'NAME ' + (c+1);
        trh.appendChild(th);
      }
      thead.appendChild(trh);
      // body
      for(const row of grid){
        const tr = document.createElement('tr');
        for(let c=0;c<cols;c++){
          const td = document.createElement('td');
          td.textContent = row[c] || '';
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      }
    }

    function getCleanList(){
      const raw = rawEl.value || '';
      if(!raw.trim()) return [];
      const removeNumbers = rmNumEl.checked;
      let items = parseRaw(raw);
      items = items.map(it => cleanItem(it, removeNumbers)).filter(Boolean);
      return items;
    }

    arrangeBtn.addEventListener('click', ()=>{
      const items = getCleanList();
      const cols = Math.max(1, parseInt(perRowEl.value) || 5);
      const grid = buildGrid(items, cols);
      renderTable(grid);
      downloadBtn.classList.remove('ghost');
    });

    downloadBtn.addEventListener('click', ()=>{
      const items = getCleanList();
      if(items.length === 0){ alert('No data to export — paste raw list first.'); return; }
      const cols = Math.max(1, parseInt(perRowEl.value) || 5);
      const grid = buildGrid(items, cols);
      // Convert to worksheet
      const ws_data = grid;
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(ws_data);
      XLSX.utils.book_append_sheet(wb, ws, 'Faculties');
      const filename = 'Faculties_Cleaned.xlsx';
      XLSX.writeFile(wb, filename);
    });

    // Pre-fill textarea with user's sample (optional) for quick testing
    const sample = `(1) Aditya Professional Academy (2) Adv Jayesh Bhandari (3) AGRIKA KHATRI, (4) CA Aaditya Jain (5) CA Aaditya Sharma (6) CA Aakash Kandoi, (7) CA Aakash Pednekar (8) CA Aarish Khan (9) CA Aarti Lahoti`;
    // rawEl.value = sample; // uncomment to prefill
  </script>
</body>
</html>
